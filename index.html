<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="tiktok-developers-site-verification" content="I9BYueDa26Qb1OSa20WDtnwSZVppkKR1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ‹’ç»åŠ ç­ï¼æ˜­å’ŒèŒåœºå¤§é€ƒæ€</title>
    <style>
        :root {
            --bg-color: #2d3436;
            --showa-red: #d63031;
            --showa-gold: #fdcb6e;
            --panel-bg: #f5e6ca;
            --btn-blue: #0984e3;
            --btn-green: #2ecc71;
            --tiktok-color: #25F4EE;
            --tiktok-secondary: #FE2C55;
        }
        * { box-sizing: border-box; user-select: none; -webkit-tap-highlight-color: transparent; }
        body { 
            margin: 0; background: var(--bg-color); 
            display: flex; justify-content: center; align-items: center; 
            min-height: 100vh; font-family: 'Microsoft YaHei', sans-serif;
            overflow: hidden; touch-action: none;
        }
        .game-container {
            position: relative; width: 100%; max-width: 450px; height: 95vh;
            background: #000; border: 6px solid #4a3020; border-radius: 20px;
            box-shadow: 0 0 40px rgba(0,0,0,0.8); overflow: hidden;
        }
        canvas { display: block; width: 100%; height: 100%; background: var(--panel-bg); }
        
        /* é¡µé¢åŸºç¡€æ ·å¼ */
        .overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            z-index: 100; padding: 20px; text-align: center;
        }

        /* é¦–é¡µçŠ¶æ€ */
        #homeScreen { background: var(--panel-bg); }
        
        /* ç»“ç®—é¡µçŠ¶æ€ */
        #gameOverScreen { display: none; background: rgba(0,0,0,0.9); color: white; }

        .title-card {
            background: var(--showa-red); color: white; padding: 15px 20px;
            border: 5px solid white; transform: rotate(-2deg);
            box-shadow: 8px 8px 0 rgba(0,0,0,0.3); margin-bottom: 20px;
            width: 100%;
        }
        
        /* ç”¨æˆ·ä¿¡æ¯åŒº */
        .user-info {
            position: absolute; top: 10px; left: 10px; right: 10px;
            display: flex; justify-content: space-between; align-items: center;
            z-index: 101; background: rgba(255,255,255,0.9);
            padding: 8px 15px; border-radius: 30px; border: 2px solid #4a3020;
            font-weight: bold;
        }
        .user-avatar {
            width: 40px; height: 40px; border-radius: 50%; background: #ddd;
            display: flex; justify-content: center; align-items: center;
            overflow: hidden;
        }
        .user-avatar img { width: 100%; height: 100%; object-fit: cover; }
        .user-name { flex: 1; margin-left: 10px; color: #333; }
        .logout-btn { 
            background: var(--tiktok-secondary); color: white; 
            border: none; padding: 5px 12px; border-radius: 20px;
            font-size: 0.9rem; cursor: pointer;
        }
        
        /* æŒ‰é’®ç»„ */
        .btn-group { width: 100%; display: flex; flex-direction: column; align-items: center; }
        .btn {
            width: 80%; background: var(--showa-gold); color: #2d3436; border: none;
            padding: 15px; font-size: 1.5rem; font-weight: 900;
            border-radius: 50px; cursor: pointer; border-bottom: 5px solid #d4a017;
            transition: 0.1s; margin: 8px 0;
        }
        .btn:active:not(:disabled) { transform: translateY(4px); border-bottom-width: 1px; }
        .btn:disabled { background: #95a5a6; border-bottom-color: #7f8c8d; color: #bdc3c7; cursor: not-allowed; }
        
        .btn-ad { background: var(--btn-blue); border-bottom-color: #06528e; color: white; }
        .btn-tiktok { 
            background: linear-gradient(135deg, var(--tiktok-color), var(--tiktok-secondary)); 
            border-bottom-color: #161616; color: white; 
        }

        /* åˆ†æ•°æ˜¾ç¤º */
        .score-ui {
            position: absolute; top: 15px; width: 100%; text-align: center;
            pointer-events: none; z-index: 50; display: none;
        }
        .score-box {
            display: inline-block; background: rgba(45, 52, 54, 0.9); 
            color: var(--showa-gold); padding: 5px 20px; border-radius: 20px;
            font-size: 1.5rem; font-weight: bold; border: 2px solid var(--showa-gold);
        }

        /* æ¨¡æ‹Ÿå¹¿å‘Šå±‚ - æ”¹ä¸ºUIæ¨¡æ‹Ÿï¼Œä¸ç”¨alert */
        #adLayer {
            display: none; position: absolute; z-index: 200; top: 0; left: 0; 
            width: 100%; height: 100%; background: rgba(0,0,0,0.9);
            color: #fff;
            justify-content: center; align-items: center; 
            font-size: 2rem;
            flex-direction: column;
        }
        
        #adLayer .ad-timer {
            font-size: 4rem;
            color: var(--tiktok-color);
            margin: 20px;
        }

        #adLayer .ad-text {
            font-size: 1.5rem;
            margin-bottom: 20px;
        }

        #adLayer .ad-skip {
            font-size: 1rem;
            color: #999;
            position: absolute;
            bottom: 30px;
        }
        
        /* æ¸…å±çˆ†ç‚¸ç‰¹æ•ˆ */
        .clear-flash {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: white; z-index: 300; pointer-events: none;
            animation: flash 0.3s ease-out;
        }
        @keyframes flash {
            0% { opacity: 0; }
            50% { opacity: 0.9; }
            100% { opacity: 0; }
        }
        
        /* ç™»å½•æˆåŠŸæç¤º */
        .login-toast {
            position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%);
            background: rgba(0,0,0,0.8); color: white; padding: 10px 20px;
            border-radius: 30px; z-index: 1000; animation: fadeInOut 2s ease;
        }
        @keyframes fadeInOut {
            0% { opacity: 0; bottom: 20px; }
            20% { opacity: 1; bottom: 30px; }
            80% { opacity: 1; bottom: 30px; }
            100% { opacity: 0; bottom: 20px; }
        }

        /* éšç§æ”¿ç­–é“¾æ¥ - å®¡æ ¸å¿…é¡» */
        .legal-links {
            position: absolute;
            bottom: 10px;
            left: 0;
            width: 100%;
            text-align: center;
            font-size: 0.7rem;
            color: #999;
            z-index: 102;
            padding: 5px;
        }
        .legal-links a {
            color: var(--tiktok-color);
            text-decoration: none;
            margin: 0 8px;
        }
        .legal-links a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>

<div class="game-container">
    <!-- ç”¨æˆ·ä¿¡æ¯æ  -->
    <div id="userInfoBar" class="user-info" style="display: none;">
        <div class="user-avatar" id="userAvatar">
            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='50' fill='%23cccccc'/%3E%3Ctext x='50' y='70' font-size='50' text-anchor='middle' fill='%23666'%3EğŸ‘¤%3C/text%3E%3C/svg%3E" alt="avatar">
        </div>
        <div class="user-name" id="userName">æœªç™»å½•</div>
        <button class="logout-btn" id="logoutBtn" onclick="game.logout()">é€€å‡º</button>
    </div>

    <canvas id="gameCanvas"></canvas>
    
    <div class="score-ui" id="inGameUI">
        <div class="score-box">å·¥èµ„: <span id="scoreVal">0</span></div>
    </div>

    <div id="homeScreen" class="overlay">
        <div class="title-card">
            <h1 style="margin:0; font-size: 2.2rem;">æ‹’ç»åŠ ç­ï¼æ˜­å’ŒèŒåœºå¤§é€ƒæ€</h1>
        </div>
        
        <!-- TikTokç™»å½•æŒ‰é’® - ä½¿ç”¨çœŸå®Client Key -->
        <div class="btn-group" style="margin-bottom: 20px;">
            <button class="btn btn-tiktok" id="tiktokLoginBtn">ğŸµ Login with TikTok</button>
        </div>
        
        <div class="btn-group">
            <button class="btn" onclick="game.start()" id="startGameBtn" disabled>æ­£å¼å…¥èŒ (éœ€ç™»å½•)</button>
            <button class="btn btn-ad" onclick="game.watchAd()" id="watchAdBtn" disabled>ğŸ“º çœ‹è§†é¢‘å¾—å¥–åŠ±</button>
        </div>
        
        <div style="margin-top: 10px; color: #666; font-size: 0.9rem;" id="loginStatus">è¯·å…ˆç™»å½•TikTok</div>
        
        <!-- éšç§æ”¿ç­–å’ŒæœåŠ¡æ¡æ¬¾é“¾æ¥ï¼ˆå®¡æ ¸å¿…é¡»ï¼‰ -->
        <div class="legal-links">
            <a href="#" onclick="game.showTerms()">Terms of Service</a> |
            <a href="#" onclick="game.showPrivacy()">Privacy Policy</a>
        </div>
    </div>

    <div id="gameOverScreen" class="overlay">
        <h2 style="color: var(--showa-red); font-size: 2.5rem; margin: 0;">è¢«è¿«åŠ ç­...</h2>
        <div style="font-size: 3rem; color: var(--showa-gold); margin: 20px 0;">ğŸ’°<span id="finalScore">0</span></div>
        
        <div class="btn-group">
            <button id="restartBtn" class="btn" onclick="game.start()">å†æ¬¡æŒ‘æˆ˜ (5s)</button>
            <button class="btn btn-ad" onclick="game.watchAd()">ğŸ“º è§‚çœ‹å¹¿å‘Šå¤æ´»</button>
        </div>
    </div>

    <!-- å¹¿å‘Šæ¨¡æ‹Ÿå±‚ - ä½¿ç”¨UIæ¨¡æ‹Ÿï¼Œä¸ç”¨alert -->
    <div id="adLayer">
        <div class="ad-text">ğŸ“º å¹¿å‘Šæ’­æ”¾ä¸­</div>
        <div class="ad-timer" id="adTimer">3</div>
        <div class="ad-skip">å¹¿å‘Šåè·å¾—å¥–åŠ±</div>
    </div>
</div>

<script>
// ========== åˆå§‹åŒ–Canvasä¸Šä¸‹æ–‡ ==========
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

// æ·»åŠ canvasåœ†è§’çŸ©å½¢æ–¹æ³•
CanvasRenderingContext2D.prototype.roundRect = function(x, y, w, h, r) {
    if (w < 2 * r) r = w / 2;
    if (h < 2 * r) r = h / 2;
    this.moveTo(x + r, y);
    this.lineTo(x + w - r, y);
    this.quadraticCurveTo(x + w, y, x + w, y + r);
    this.lineTo(x + w, y + h - r);
    this.quadraticCurveTo(x + w, y + h, x + w - r, y + h);
    this.lineTo(x + r, y + h);
    this.quadraticCurveTo(x, y + h, x, y + h - r);
    this.lineTo(x, y + r);
    this.quadraticCurveTo(x, y, x + r, y);
    this.closePath();
    return this;
};

const config = {
    itemW: 45, itemH: 90,
    items: [
        { text: "åŠ ç­", color: "#d63031", isKiller: true, weight: 0.45 },
        { text: "å·¥èµ„", color: "#2ecc71", isKiller: false, score: 100, weight: 0.3 },
        { text: "å¥–é‡‘", color: "#f1c40f", isKiller: false, score: 500, weight: 0.15 },
        { text: "ä¼‘å‡", color: "#9b59b6", isKiller: false, isClear: true, score: 200, weight: 0.1 }
    ]
};

// ========== æ¸¸æˆä¸»å¯¹è±¡ ==========
const game = {
    active: false,
    score: 0,
    items: [],
    playerX: 0,
    targetX: 0,
    isLoggedIn: false,
    accessToken: null,
    openId: null,

    init() {
        canvas.width = canvas.parentElement.clientWidth;
        canvas.height = canvas.parentElement.clientHeight;
        this.playerX = canvas.width / 2;
        this.targetX = this.playerX;
        
        // ç»‘å®šç§»åŠ¨
        const move = (e) => {
            if (!this.active) return;
            e.preventDefault();
            const x = e.touches ? e.touches[0].clientX : e.clientX;
            const rect = canvas.getBoundingClientRect();
            this.targetX = x - rect.left;
        };
        canvas.addEventListener('mousemove', move);
        canvas.addEventListener('touchmove', move, { passive: false });
        canvas.addEventListener('contextmenu', (e) => e.preventDefault());
        
        // ç»‘å®šTikTokç™»å½•æŒ‰é’®
        document.getElementById('tiktokLoginBtn').addEventListener('click', loginWithTikTok);
        
        // æ£€æŸ¥æœ¬åœ°å­˜å‚¨çš„ç™»å½•çŠ¶æ€
        this.checkStoredLogin();
        
        // å¤„ç†TikTokå›è°ƒï¼ˆçœŸå®codeè¿”å›ï¼‰
        this.handleTikTokCallback();
        
        this.render();
    },
    
    // æ£€æŸ¥æœ¬åœ°å­˜å‚¨
    checkStoredLogin() {
        const token = localStorage.getItem('tiktok_access_token');
        const userInfo = localStorage.getItem('tiktok_user');
        
        if (token && userInfo) {
            this.accessToken = token;
            try {
                const user = JSON.parse(userInfo);
                this.showLoginSuccess(user);
            } catch (e) {}
        }
    },
    
    // TikTokå›è°ƒå¤„ç† - è°ƒç”¨çœŸå®åç«¯
    handleTikTokCallback() {
        const params = new URLSearchParams(window.location.search);
        const code = params.get("code");
        const state = params.get("state");

        if (!code || state !== "game_login") return;

        this.showToast("ğŸ”„ æ­£åœ¨ç™»å½•...");
        this.exchangeTokenWithBackend(code);

        window.history.replaceState({}, document.title, window.location.pathname);
    },

    // è°ƒç”¨ Render åç«¯
    async exchangeTokenWithBackend(code) {
        try {
            const response = await fetch(
                "https://tiktok-backend-62sk.onrender.com/api/auth/token",
                {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify({ code })
                }
            );

            const data = await response.json();

            if (data.success) {
                localStorage.setItem("tiktok_access_token", data.access_token);
                localStorage.setItem("tiktok_user", JSON.stringify(data.user));
                localStorage.setItem("tiktok_refresh_token", data.refresh_token);

                this.showLoginSuccess(data.user);
                this.showToast("âœ… TikTokç™»å½•æˆåŠŸ");
            } else {
                this.showToast("âŒ ç™»å½•å¤±è´¥");
            }

        } catch (err) {
            console.error(err);
            this.showToast("âŒ ç½‘ç»œé”™è¯¯");
        }
    },
    
    // æ˜¾ç¤ºç™»å½•æˆåŠŸ
    showLoginSuccess(userInfo) {
        this.isLoggedIn = true;
        
        // æ›´æ–°ç”¨æˆ·ä¿¡æ¯æ 
        document.getElementById('userName').innerText = userInfo.name;
        const avatarImg = document.querySelector('#userAvatar img');
        avatarImg.src = userInfo.avatar;
        document.getElementById('userInfoBar').style.display = 'flex';
        
        // å¯ç”¨æ‰€æœ‰æŒ‰é’®
        document.getElementById('startGameBtn').disabled = false;
        document.getElementById('watchAdBtn').disabled = false;
        
        // æ›´æ–°çŠ¶æ€æ–‡å­—
        document.getElementById('loginStatus').innerHTML = 'âœ… å·²ç™»å½•ï¼š' + userInfo.name;
    },
    
    // é€€å‡ºç™»å½•
    logout() {
        this.isLoggedIn = false;
        this.accessToken = null;
        localStorage.removeItem('tiktok_access_token');
        localStorage.removeItem('tiktok_user');
        
        document.getElementById('userInfoBar').style.display = 'none';
        document.getElementById('startGameBtn').disabled = true;
        document.getElementById('watchAdBtn').disabled = true;
        document.getElementById('loginStatus').innerHTML = 'è¯·å…ˆç™»å½•TikTok';
        
        this.showToast('ğŸ‘‹ å·²é€€å‡ºç™»å½•');
    },
    
    // æ˜¾ç¤ºæç¤º
    showToast(message) {
        const toast = document.createElement('div');
        toast.className = 'login-toast';
        toast.innerText = message;
        document.querySelector('.game-container').appendChild(toast);
        setTimeout(() => toast.remove(), 2000);
    },

    // æ˜¾ç¤ºæœåŠ¡æ¡æ¬¾ï¼ˆå®¡æ ¸å¿…é¡»ï¼‰
    showTerms() {
        const terms = "TERMS OF SERVICE\n\nThis game uses TikTok Login for authentication. " +
                     "No personal data is stored on our servers. All data is handled according to " +
                     "TikTok's API policies. By using this game, you agree to these terms.";
        alert(terms);
    },
    
    // æ˜¾ç¤ºéšç§æ”¿ç­–ï¼ˆå®¡æ ¸å¿…é¡»ï¼‰
    showPrivacy() {
        const privacy = "PRIVACY POLICY\n\nWe only access your TikTok profile information (name, avatar) " +
                       "through TikTok's official API. This information is stored locally on your device " +
                       "and is not shared with any third parties. We do not collect any other personal data.";
        alert(privacy);
    },

    // å¼€å§‹æ¸¸æˆ
    start() {
        if (!this.isLoggedIn) {
            this.showToast('è¯·å…ˆç™»å½•TikTok');
            return;
        }
        
        document.getElementById('homeScreen').style.display = 'none';
        document.getElementById('gameOverScreen').style.display = 'none';
        document.getElementById('inGameUI').style.display = 'block';
        
        this.score = 0;
        this.items = [];
        this.active = true;
        document.getElementById('scoreVal').innerText = '0';
    },

    // æ¸¸æˆç»“æŸ
    die() {
        this.active = false;
        document.getElementById('gameOverScreen').style.display = 'flex';
        document.getElementById('finalScore').innerText = this.score;
        
        const btn = document.getElementById('restartBtn');
        let timeLeft = 5;
        btn.disabled = true;
        
        const timer = setInterval(() => {
            timeLeft--;
            if (timeLeft <= 0) {
                clearInterval(timer);
                btn.disabled = false;
                btn.innerText = "å†æ¬¡æŒ‘æˆ˜";
            } else {
                btn.innerText = `å†æ¬¡æŒ‘æˆ˜ (${timeLeft}s)`;
            }
        }, 1000);
    },

    // çœ‹å¹¿å‘Šé€»è¾‘ - ä½¿ç”¨UIæ¨¡æ‹Ÿï¼Œä¸ç”¨alert
    watchAd() {
        if (!this.isLoggedIn) {
            this.showToast('è¯·å…ˆç™»å½•TikTok');
            return;
        }
        
        const adLayer = document.getElementById('adLayer');
        const adTimer = document.getElementById('adTimer');
        adLayer.style.display = 'flex';
        
        let count = 3;
        adTimer.innerText = count;
        
        const itv = setInterval(() => {
            count--;
            adTimer.innerText = count;
            if(count <= 0) {
                clearInterval(itv);
                adLayer.style.display = 'none';
                
                // å¹¿å‘Šè§‚çœ‹å®Œæ¯•ï¼Œå‘æ”¾å¥–åŠ±
                this.showToast("ğŸ è·å¾—å¥–åŠ±");
                
                if (!this.active) {
                    this.start();  // å¤æ´»
                } else {
                    this.score += 500;
                    document.getElementById('scoreVal').innerText = this.score;
                }
            }
        }, 1000);
    },
    
    // æ¸…å±ç‰¹æ•ˆ
    clearScreen() {
        const flash = document.createElement('div');
        flash.className = 'clear-flash';
        document.querySelector('.game-container').appendChild(flash);
        setTimeout(() => flash.remove(), 300);
        
        this.items = [];
        this.score += 200;
        document.getElementById('scoreVal').innerText = this.score;
    },

    update() {
        if (!this.active) return;

        this.playerX += (this.targetX - this.playerX) * 0.2;
        
        // è¾¹ç•Œé™åˆ¶
        if (this.playerX < 30) this.playerX = 30;
        if (this.playerX > canvas.width - 30) this.playerX = canvas.width - 30;
        
        // ç”Ÿæˆç‰©å“
        if (Math.random() < 0.04) {
            let r = Math.random();
            let cumWeight = 0;
            let selectedType = config.items[0];
            
            for (let type of config.items) {
                cumWeight += type.weight;
                if (r < cumWeight) {
                    selectedType = type;
                    break;
                }
            }
            
            this.items.push({
                x: Math.random() * (canvas.width - 60) + 30,
                y: -100,
                type: selectedType,
                speed: 4 + (this.score / 2000)
            });
        }

        for (let i = this.items.length - 1; i >= 0; i--) {
            const it = this.items[i];
            it.y += it.speed;

            const playerRect = {
                x: this.playerX - 25,
                y: canvas.height - 95,
                w: 50,
                h: 70
            };
            
            const itemRect = {
                x: it.x - config.itemW/2,
                y: it.y - config.itemH/2,
                w: config.itemW,
                h: config.itemH
            };

            if (this.rectCollide(playerRect, itemRect)) {
                if (it.type.isKiller) {
                    this.die();
                    return;
                } else {
                    if (it.type.isClear) {
                        this.clearScreen();
                        this.items.splice(i, 1);
                        break;
                    } else {
                        this.score += it.type.score;
                        document.getElementById('scoreVal').innerText = this.score;
                        this.items.splice(i, 1);
                    }
                }
            } else if (it.y > canvas.height + 100) {
                this.items.splice(i, 1);
            }
        }
    },
    
    rectCollide(r1, r2) {
        return !(r2.x > r1.x + r1.w ||
                 r2.x + r2.w < r1.x ||
                 r2.y > r1.y + r1.h ||
                 r2.y + r2.h < r1.y);
    },

    draw() {
        ctx.fillStyle = '#f5e6ca';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        
        ctx.strokeStyle = '#c0a070';
        ctx.lineWidth = 0.5;
        for (let i = 0; i < canvas.width; i += 40) {
            ctx.beginPath();
            ctx.moveTo(i, 0);
            ctx.lineTo(i, canvas.height);
            ctx.stroke();
        }
        
        ctx.fillStyle = '#2d3436';
        ctx.fillRect(this.playerX - 25, canvas.height - 95, 50, 50);
        ctx.fillStyle = '#ffcc99';
        ctx.beginPath(); 
        ctx.arc(this.playerX, canvas.height - 110, 20, 0, Math.PI*2); 
        ctx.fill();
        
        ctx.fillStyle = '#000';
        ctx.beginPath();
        ctx.arc(this.playerX - 8, canvas.height - 117, 3, 0, Math.PI*2);
        ctx.arc(this.playerX + 8, canvas.height - 117, 3, 0, Math.PI*2);
        ctx.fill();

        this.items.forEach(it => {
            ctx.fillStyle = it.type.color;
            ctx.strokeStyle = '#000';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.roundRect(it.x - config.itemW/2, it.y - config.itemH/2, config.itemW, config.itemH, 8);
            ctx.fill(); 
            ctx.stroke();

            ctx.fillStyle = '#fff';
            ctx.font = 'bold 24px "Microsoft YaHei"';
            ctx.textAlign = 'center';
            const chars = it.type.text.split('');
            chars.forEach((c, idx) => ctx.fillText(c, it.x, it.y - 15 + idx * 30));
        });
    },

    render() {
        this.update();
        this.draw();
        requestAnimationFrame(() => this.render());
    }
};

window.onload = () => game.init();
</script>

<!-- ===== TikTok ç™»å½•é…ç½® - Client Keyå·²æ›´æ–° ===== -->
<script>
// â˜…â˜…â˜… æ‚¨çš„client keyå·²æ›´æ–° â˜…â˜…â˜…
const TIKTOK_CLIENT_KEY = "awrjc36v2o7a2owa";   // æ–°Client Key
// âœ… æ”¹æˆ callback è·¯å¾„ï¼Œä¸ç”¨ index.html
const REDIRECT_URI = "https://xmansea51-web.github.io/callback/";

// ===== ç‚¹å‡»ç™»å½• =====
function loginWithTikTok() {
  const authUrl =
    "https://www.tiktok.com/v2/auth/authorize/?" +
    "client_key=" + TIKTOK_CLIENT_KEY +
    "&scope=user.info.profile" +
    "&response_type=code" +
    "&redirect_uri=" + encodeURIComponent(REDIRECT_URI) +
    "&state=game_login";

  window.location.href = authUrl;
}
</script>

</body>
</html>
